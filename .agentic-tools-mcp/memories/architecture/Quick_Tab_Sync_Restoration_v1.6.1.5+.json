{
  "id": "55af7c56-8e07-4454-ba2e-4ce29e22334c",
  "title": "Quick Tab Sync Restoration v1.6.1.5+",
  "details": "## Quick Tab Cross-Domain Sync Restoration\n\n### Implementation Summary\nRe-enabled cross-domain Quick Tab synchronization with four layers of memory leak protection.\n\n### Protection Layers\n\n**Layer 1: Rate Limiting**\n- Location: `BroadcastManager._checkWriteRateLimit()`\n- Max 10 storage writes per second\n- Called first in `_persistBroadcastMessage()`\n\n**Layer 2: Write Source Tracking**\n- Each storage write tagged with `writeSource: senderId`\n- `SyncCoordinator._isOwnWrite()` checks this to ignore own writes\n\n**Layer 3: Hash-Based Deduplication**\n- Location: `SyncCoordinator._isDuplicateMessage()`\n- Uses `timestamp-quickTabIds` hash\n- 30-second TTL (`SyncCoordinator.DEDUP_TTL_MS`)\n- Cleanup every 5 seconds (`SyncCoordinator.DEDUP_CLEANUP_INTERVAL_MS`)\n\n**Layer 4: Implicit Debouncing**\n- Via rate limiter batching during rapid drag operations\n\n### Key Files Modified\n\n1. **BroadcastManager.js**\n   - Re-enabled `_persistBroadcastMessage()` with rate limiting\n   - Re-enabled `replayBroadcastHistory()` with TTL filtering\n\n2. **SyncCoordinator.js**\n   - Added static constants `DEDUP_TTL_MS`, `DEDUP_CLEANUP_INTERVAL_MS`\n   - Added `_isOwnWrite()`, `_isDuplicateMessage()`, `_hashMessage()`\n   - Added `_cleanupOldProcessedMessages()`, `_recordProcessedMessage()`\n\n3. **StorageManager.js**\n   - `loadAll()` now loads from ALL containers globally\n   - Added `loadFromCurrentContainer()` for container-specific loading\n   - Added filtering for `quick_tabs_broadcast_history_` storage keys\n\n### Storage Key Patterns\n- `quick_tabs_broadcast_history_${cookieStoreId}` - Broadcast history\n- `quick-tabs-sync-${cookieStoreId}-${timestamp}` - Storage fallback messages\n- Both filtered to prevent feedback loops\n\n### Reference\nSee: docs/manual/v1.6.0/quick-tab-sync-restoration-guide.md",
  "category": "architecture",
  "dateCreated": "2025-11-25T00:21:04.140Z",
  "dateUpdated": "2025-11-25T00:21:04.140Z"
}