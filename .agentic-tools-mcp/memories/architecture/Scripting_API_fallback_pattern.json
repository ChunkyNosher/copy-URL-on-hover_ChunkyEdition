{
  "id": "3a238b25-63cf-4622-8301-ff473b66f31a",
  "title": "Scripting API fallback pattern",
  "details": "The Scripting API fallback pattern in background.js (v1.6.3.10-v5):\n\n1. Use `createTimeoutPromise(timeoutMs, message)` helper for Promise.race() timeouts\n2. Use `generateCorrelationId(prefix)` helper for unique tracing IDs\n3. Pattern for timeout-protected messaging with fallback:\n   - Wrap browser.tabs.sendMessage() in Promise.race() with 2s timeout\n   - On failure/timeout, fall back to browser.scripting.executeScript()\n   - Scripting API calls executeScriptedOperation() which accesses window.CopyURLExtension.quickTabsManager\n\nThis pattern ensures atomic operation completion even when messaging layer fails (port dead, timeout, Firefox terminating background script).",
  "category": "architecture",
  "dateCreated": "2025-12-17T20:38:28.516Z",
  "dateUpdated": "2025-12-17T20:38:28.516Z"
}