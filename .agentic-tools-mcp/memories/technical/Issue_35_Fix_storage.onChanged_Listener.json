{
  "id": "a4c85b48-2c7a-4de8-8872-1f97602f6d92",
  "title": "Issue 35 Fix: storage.onChanged Listener",
  "details": "## storage.onChanged Cross-Tab Sync Fix (Issue #35)\n\n**Root Cause:** Content scripts weren't registering their own storage.onChanged listeners. Each browser tab/content script must register its own listener - they are NOT shared across contexts.\n\n**Key Insight from Mozilla Docs:** \"storage.onChanged fires in all contexts where the storage API is available\" - meaning EACH content script must independently register a listener.\n\n**Fix Applied (v1.6.2.1):**\n1. Enhanced StorageManager.setupStorageListeners() with context-aware logging\n2. Added \"LISTENER FIRED\" debug log to confirm listener is active in each tab\n3. Added context detection: `typeof window !== 'undefined' ? 'content-script' : 'background'`\n4. StorageManager._onStorageChanged(), handleStorageChange(), scheduleStorageSync() all log context\n5. SyncCoordinator.setupListeners() and handleStorageChange() log context\n6. UICoordinator.setupStateListeners() logs when state events are received\n\n**Event Flow:**\n```\nTab A writes to storage.local\n    ↓\nstorage.onChanged fires in Tab B, C, D (NOT Tab A)\n    ↓\nStorageManager._onStorageChanged() → scheduleStorageSync()\n    ↓\neventBus.emit('storage:changed')\n    ↓\nSyncCoordinator.handleStorageChange()\n    ↓\nStateManager.hydrate() → emit state:added/updated/deleted events\n    ↓\nUICoordinator event listeners → render/update/destroy Quick Tabs\n```\n\n**Expected Behavior:**\n- Logs show \"*** LISTENER FIRED ***\" in EVERY tab independently\n- Quick Tab created in Tab A immediately appears in Tab B\n- Background script only updates its cache, doesn't broadcast",
  "category": "technical",
  "dateCreated": "2025-11-25T18:02:31.945Z",
  "dateUpdated": "2025-11-25T18:02:31.945Z"
}