{
  "id": "b7a3c9b7-ed47-4b3a-8715-7c9a7c3fff1e",
  "title": "v1.6.3.4-v5 Spam-Click Fixes",
  "details": "## v1.6.3.4-v5 Spam-Click Issues Fix Summary\n\nFixed all 7 Quick Tab minimize/restore spam-click issues:\n\n### Issue 1: Ghost Tabs\n- Emit state:updated even when snapshot not found\n- VisibilityHandler: handleRestore() calls _emitRestoreStateUpdate() even on failed restore\n\n### Issue 2: Wrong Minimized Count\n- Update entity.minimized = false in quickTabsMap BEFORE other restore operations\n- tabWindow IS the entity (same object) - no need for duplicate Map.get()\n\n### Issue 3: Stale Drag Callbacks\n- Already fixed in v1.6.3.2 with destroyed flag in DragController\n- All handlers check this.destroyed before executing\n\n### Issue 4: Manager Button State\n- Added PENDING_OPERATIONS Set to track in-progress operations\n- Disable minimize button when restore pending (domVerified=false)\n- 2-second timeout safety net to clear pending state\n\n### Issue 5: Early Snapshot Clear\n- Added SNAPSHOT_CLEAR_DELAY_MS = 400ms constant\n- New _scheduleSnapshotClearing() method delays snapshot clearing\n- Cancellable timer pattern allows double-clicks within grace period\n\n### Issue 6: Storage/DOM Race\n- Adjusted timing constants:\n  - STATE_EMIT_DELAY_MS = 100ms (was 200ms)\n  - MINIMIZE_DEBOUNCE_MS = 200ms (was 150ms)\n- Now state:updated event fires before storage persist\n\n### Issue 7: Three-Way State Desync\n- Entity state updated FIRST in both handleMinimize() and handleRestore()\n- tabWindow.minimized = true/false set BEFORE any other operations\n- tabWindow IS the entity in quickTabsMap (same object reference)\n\n### Key Insight\n- tabWindow and entity are the SAME object in quickTabsMap\n- No need for duplicate this.quickTabsMap.get(id) calls",
  "category": "bugfix",
  "dateCreated": "2025-12-01T03:47:32.821Z",
  "dateUpdated": "2025-12-01T03:47:32.821Z"
}